<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schweizer Kündigungsfristenrechner - Kündigungsfristen berechnen</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <meta name="description" content="Berechnen Sie Kündigungsfristen für Arbeitsverträge, Mietverträge, Versicherungen und Abos nach Schweizer Recht. OR, VVG, KVG.">
    <meta name="keywords" content="Kündigungsfrist, Kündigungsrechner, Arbeitsvertrag, Mietvertrag, Versicherung, Krankenkasse, Fitness-Abo, Handy-Abo, OR Art. 335, OR Art. 266, VVG, KVG, Schweiz, Kündigung">
    <meta name="author" content="Durchblick Consultancy BV">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://frist.ch/de/kuendigung.html">
    <meta property="og:title" content="Schweizer Kündigungsfristenrechner">
    <meta property="og:description" content="Berechnen Sie Kündigungsfristen für Arbeitsverträge und Mietverträge nach Schweizer Recht.">
    <meta property="og:image" content="https://frist.ch/images/og-frist-de.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="de_CH">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Schweizer Kündigungsfristenrechner">
    <meta name="twitter:description" content="Berechnen Sie Kündigungsfristen für Arbeitsverträge und Mietverträge nach Schweizer Recht.">
    <meta name="twitter:image" content="https://frist.ch/images/og-frist-de.png">

    <!-- Canonical & Language -->
    <link rel="canonical" href="https://frist.ch/de/kuendigung.html">
    <link rel="alternate" hreflang="de" href="https://frist.ch/de/kuendigung.html">
    <link rel="alternate" hreflang="fr" href="https://frist.ch/fr/kuendigung.html">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Schweizer Kündigungsfristenrechner",
        "description": "Berechnen Sie Kündigungsfristen für Arbeitsverträge und Mietverträge nach Schweizer Recht",
        "url": "https://frist.ch/de/kuendigung.html",
        "applicationCategory": "LegalService",
        "operatingSystem": "Web",
        "inLanguage": "de-CH",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CHF"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Durchblick Consultancy BV",
            "url": "https://durchblick.nl"
        }
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Economica:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .tool-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tool-nav a {
            padding: 8px 16px;
            background: #f5f5f5;
            border-radius: 4px;
            text-decoration: none;
            color: #3f606f;
            font-family: 'Economica', sans-serif;
            font-weight: 600;
            transition: all 0.2s;
        }
        .tool-nav a:hover {
            background: #e0e0e0;
        }
        .tool-nav a.active {
            background: #3f606f;
            color: white;
        }
        .contract-type-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #3f606f;
        }
        .contract-type-info h4 {
            margin: 0 0 8px 0;
            color: #3f606f;
        }
        .contract-type-info p {
            margin: 0;
            font-size: 0.9rem;
        }
        .timeline-visual {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .timeline-bar {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        .timeline-point {
            text-align: center;
            flex: 0 0 auto;
        }
        .timeline-point .dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #3f606f;
            margin: 0 auto 5px;
        }
        .timeline-point .dot.end {
            background: #cc5c53;
        }
        .timeline-line {
            flex: 1;
            height: 3px;
            background: linear-gradient(to right, #3f606f, #cc5c53);
            margin: 0 10px;
        }
        .timeline-point small {
            font-size: 0.75rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-row">
            <div class="language-switcher">
                <a href="../de/kuendigung.html" class="lang-btn active">DE</a>
                <a href="../fr/kuendigung.html" class="lang-btn">FR</a>
            </div>
        </div>

        <h1><img src="../favicon.svg" alt="" class="title-icon">Kündigungsfristenrechner</h1>

        <nav class="tool-nav">
            <a href="../de/">Fristenrechner</a>
            <a href="../de/verjaehrung.html">Verjährungsrechner</a>
            <a href="../de/kuendigung.html" class="active">Kündigungsfristen</a>
        </nav>

        <div class="steps-container">
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-file-signature"></i>
                    <div class="step-number">1</div>
                </div>
                <div class="step-content">
                    <h3>Vertragsart wählen</h3>
                    <p>Wählen Sie die Art des Vertrags: Arbeitsvertrag, Mietvertrag oder anderer Vertrag.</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="step-number">2</div>
                </div>
                <div class="step-content">
                    <h3>Kündigungsdatum eingeben</h3>
                    <p>Geben Sie das Datum ein, an dem die Kündigung zugestellt wird.</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-door-open"></i>
                    <div class="step-number">3</div>
                </div>
                <div class="step-content">
                    <h3>Frühester Kündigungstermin</h3>
                    <p>Erfahren Sie, zu welchem Termin das Vertragsverhältnis frühestens enden kann.</p>
                </div>
            </div>
        </div>

        <div class="calculator-card">
            <form id="kuendigungForm">
                <div class="form-group">
                    <label for="contractType" class="required">Vertragsart
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Je nach Vertragsart gelten unterschiedliche Kündigungsfristen und Termine.</span>
                        </span>
                    </label>
                    <select id="contractType" name="contractType" required onchange="updateContractInfo()">
                        <option value="">Bitte wählen...</option>
                        <optgroup label="Arbeitsvertrag (OR Art. 335)">
                            <option value="work_probation">Probezeit (7 Tage)</option>
                            <option value="work_year1">1. Dienstjahr (1 Monat)</option>
                            <option value="work_year2_9">2.-9. Dienstjahr (2 Monate)</option>
                            <option value="work_year10">Ab 10. Dienstjahr (3 Monate)</option>
                        </optgroup>
                        <optgroup label="Mietvertrag (OR Art. 266)">
                            <option value="rent_apartment">Wohnung (3 Monate auf Quartal)</option>
                            <option value="rent_business">Geschäftsräume (6 Monate auf Quartal)</option>
                            <option value="rent_room">Möbliertes Zimmer (2 Wochen auf Monatsende)</option>
                            <option value="rent_parking">Parkplatz (2 Wochen auf Monatsende)</option>
                        </optgroup>
                        <optgroup label="Versicherungen">
                            <option value="insurance_health_basic">Krankenkasse Grundversicherung (30. November)</option>
                            <option value="insurance_health_extra">Krankenkasse Zusatzversicherung (3 Monate)</option>
                            <option value="insurance_property">Sach-/Autoversicherung (3 Monate)</option>
                            <option value="insurance_life">Lebensversicherung (3 Monate)</option>
                        </optgroup>
                        <optgroup label="Abonnemente">
                            <option value="subscription_fitness">Fitness-Abo (3 Monate vor Ablauf)</option>
                            <option value="subscription_mobile">Handy-Abo (60 Tage)</option>
                            <option value="subscription_internet">Internet/TV (60 Tage)</option>
                            <option value="subscription_streaming">Streaming/Zeitschrift (1 Monat)</option>
                        </optgroup>
                        <optgroup label="Andere Verträge">
                            <option value="custom">Individuelle Kündigungsfrist</option>
                        </optgroup>
                    </select>
                    <div id="contractTypeInfo" class="contract-type-info" style="display: none;"></div>
                </div>

                <div class="form-group" id="customPeriodGroup" style="display: none;">
                    <label for="customMonths" class="required">Kündigungsfrist (Monate)</label>
                    <input type="number" id="customMonths" name="customMonths" min="1" max="24" placeholder="z.B. 3">
                </div>

                <div class="form-group" id="customTermGroup" style="display: none;">
                    <label for="customTerm">Kündigungstermin</label>
                    <select id="customTerm" name="customTerm">
                        <option value="any">Jederzeit (ohne spezifischen Termin)</option>
                        <option value="month_end">Auf Monatsende</option>
                        <option value="quarter_end">Auf Quartalsende</option>
                    </select>
                </div>

                <div class="form-group" id="workStartGroup" style="display: none;">
                    <label for="workStartDate">Datum des Arbeitsbeginns
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Zur Berechnung des Dienstjahres und der korrekten Kündigungsfrist.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="workStartDate"
                           name="workStartDate"
                           title="Arbeitsbeginn"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: TT.MM.JJJJ (optional)</small>
                </div>

                <div class="form-group">
                    <label for="noticeDate" class="required">Datum der Kündigung (Zustellung)
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Das Datum, an dem die Kündigung dem Empfänger zugeht. Bei eingeschriebenen Briefen: Datum der Zustellung oder Ende der Abholfrist.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="noticeDate"
                           name="noticeDate"
                           required
                           title="Kündigungsdatum"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: TT.MM.JJJJ</small>
                </div>

                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    Achtung: Dies sind gesetzliche Mindestfristen. Vertraglich können längere Fristen vereinbart sein. Prüfen Sie Ihren Vertrag!
                </div>

                <button type="submit">Kündigungstermin berechnen</button>
            </form>

            <div id="result" class="result" style="display: none;">
                <div class="result-actions">
                    <button type="button" onclick="exportPDF()" class="print-button">
                        <i class="fas fa-file-pdf"></i> Als PDF speichern
                    </button>
                </div>
                <div class="result-summary"></div>
            </div>
        </div>

        <div class="info-cards-container">
            <div class="info-step-card highlight">
                <div class="step-icon">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="step-content">
                    <h3>Arbeitsvertrag (OR Art. 335)</h3>
                    <p>Gesetzliche Kündigungsfristen:</p>
                    <ul>
                        <li><strong>Probezeit:</strong> 7 Tage (jederzeit)</li>
                        <li><strong>1. Dienstjahr:</strong> 1 Monat auf Monatsende</li>
                        <li><strong>2.-9. Dienstjahr:</strong> 2 Monate auf Monatsende</li>
                        <li><strong>Ab 10. Dienstjahr:</strong> 3 Monate auf Monatsende</li>
                    </ul>
                    <p style="margin-top: 0.5rem;"><small>Längere Fristen können vertraglich vereinbart werden.</small></p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-home"></i>
                </div>
                <div class="step-content">
                    <h3>Mietvertrag Wohnung (OR Art. 266c)</h3>
                    <p>Kündigungsfrist: <strong>3 Monate</strong></p>
                    <p>Kündigungstermin: <strong>Ortsüblicher Termin</strong> (meist Quartalsende: 31.3., 30.6., 30.9., 31.12.)</p>
                    <p style="margin-top: 0.5rem;">In vielen Kantonen auch zum Monatsende möglich. Prüfen Sie Ihren Mietvertrag!</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-store"></i>
                </div>
                <div class="step-content">
                    <h3>Geschäftsräume (OR Art. 266d)</h3>
                    <p>Kündigungsfrist: <strong>6 Monate</strong></p>
                    <p>Kündigungstermin: <strong>Ortsüblicher Termin</strong> (meist Quartalsende)</p>
                    <p style="margin-top: 0.5rem;">Bei Geschäftsmiete sind längere vertragliche Fristen üblich.</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="step-content">
                    <h3>Versicherungen (VVG/KVG)</h3>
                    <p><strong>Krankenkasse Grund:</strong> Kündigung bis 30. November für Wechsel per 1. Januar</p>
                    <p><strong>Sachversicherung:</strong> 3 Monate auf Ende Versicherungsjahr</p>
                    <p style="margin-top: 0.5rem;">Seit VVG 2022: Alle Verträge kündbar nach 3 Jahren mit 3 Monaten Frist.</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <div class="step-content">
                    <h3>Abonnemente</h3>
                    <p><strong>Fitness:</strong> Meist 3 Monate vor Ablauf</p>
                    <p><strong>Handy/Internet:</strong> Meist 60 Tage vor Ablauf</p>
                    <p style="margin-top: 0.5rem;">Bei Umzug &gt;30km: Ausserordentliche Kündigung oft möglich.</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-exclamation-circle"></i>
                </div>
                <div class="step-content">
                    <h3>Wichtige Hinweise</h3>
                    <p><strong>Zugang der Kündigung:</strong> Die Kündigung muss vor Beginn der Frist beim Empfänger eingehen. Bei Einschreiben: spätestens am letzten Tag der Abholfrist.</p>
                    <p style="margin-top: 0.5rem;"><strong>Formvorschriften:</strong> Mietkündigungen müssen auf amtlichem Formular erfolgen (Wohnung). Arbeitskündigungen sind formfrei.</p>
                </div>
            </div>
        </div>

        <div class="law-section">
            <h2>Gesetzliche Grundlagen</h2>
            <p class="law-subtitle">Schweizerisches Obligationenrecht (OR)</p>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_335_c" target="_blank" rel="noopener">Art. 335c OR – Kündigungsfristen Arbeitsvertrag <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <ol>
                        <li>Das Arbeitsverhältnis kann im ersten Dienstjahr mit einer Kündigungsfrist von einem Monat, im zweiten bis und mit dem neunten Dienstjahr mit einer Frist von zwei Monaten und nachher mit einer Frist von drei Monaten je auf das Ende eines Monats gekündigt werden.</li>
                        <li>Diese Fristen dürfen durch schriftliche Abrede, Normalarbeitsvertrag oder Gesamtarbeitsvertrag abgeändert werden; unter einen Monat dürfen sie jedoch nur durch Gesamtarbeitsvertrag und nur für das erste Dienstjahr herabgesetzt werden.</li>
                    </ol>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_266_c" target="_blank" rel="noopener">Art. 266c OR – Kündigung Wohnung <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <p>Bei der Miete von Wohnungen können die Parteien mit einer Frist von drei Monaten auf einen ortsüblichen Termin oder, wenn es keinen Ortsgebrauch gibt, auf Ende einer dreimonatigen Mietdauer kündigen.</p>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_266_d" target="_blank" rel="noopener">Art. 266d OR – Kündigung Geschäftsräume <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <p>Bei der Miete von Geschäftsräumen können die Parteien mit einer Frist von sechs Monaten auf einen ortsüblichen Termin oder, wenn es keinen Ortsgebrauch gibt, auf Ende einer dreimonatigen Mietdauer kündigen.</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p><a href="https://durchblick.nl/tools_de.html" target="_blank" rel="noopener">Durchblick Consultancy BV – Kostenlose Rechtstools für die Schweiz</a></p>
            <p class="footer-disclaimer">Dieser Rechner dient nur zur Orientierung. Keine Rechtsberatung.</p>
            <p class="footer-privacy">Alle Berechnungen erfolgen direkt in Ihrem Browser. Es werden keine Nutzerdaten erhoben oder gespeichert.</p>
        </div>
    </footer>

    <div class="print-header" style="display: none;">
        <img src="https://www.durchblick.nl/images/durchblick_logo.svg"
             alt="Durchblick Consultancy Logo">
        <div>
            <h2>Kündigungsfristberechnung</h2>
            <p id="printDate" style="font-size: 0.9rem; color: #666; margin-top: 0.25rem;"></p>
        </div>
    </div>

    <div class="print-footer" style="display: none;">
        <p><strong>frist.ch</strong> – Kündigungsfristenrechner nach Schweizerischem Obligationenrecht</p>
        <p>Dieser Ausdruck dient nur zur Orientierung. Keine Rechtsberatung.</p>
    </div>

    <div id="disclaimerModal" class="modal">
        <div class="modal-content">
            <h2>Rechtlicher Hinweis</h2>
            <div class="disclaimer-text">
                <p><strong>Haftungsausschluss und Nutzungsbedingungen</strong></p>
                <p>Durchblick Consultancy BV stellt diesen Kündigungsfristenrechner als unverbindliches Hilfsmittel zur Verfügung. Trotz sorgfältiger Entwicklung kann keine Gewähr für die Richtigkeit der Berechnungen übernommen werden.</p>

                <p>Insbesondere wird darauf hingewiesen:</p>
                <ul>
                    <li>Der Rechner zeigt nur gesetzliche Mindestfristen. Vertragliche Abweichungen sind möglich.</li>
                    <li>Prüfen Sie immer Ihren Vertrag auf individuelle Regelungen.</li>
                    <li>Durchblick Consultancy BV übernimmt keine Haftung für Schäden aus der Nutzung.</li>
                </ul>

                <p>Mit der Nutzung akzeptieren Sie diese Bedingungen.</p>
            </div>
            <button onclick="acceptDisclaimer()" class="accept-button">
                Ich habe den Hinweis gelesen und akzeptiere die Bedingungen
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        const contractTypes = {
            'work_probation': {
                name: 'Probezeit',
                article: 'OR Art. 335b',
                days: 7,
                term: 'any',
                info: 'Während der Probezeit (max. 3 Monate) kann mit 7 Tagen Frist jederzeit gekündigt werden.'
            },
            'work_year1': {
                name: '1. Dienstjahr',
                article: 'OR Art. 335c',
                months: 1,
                term: 'month_end',
                info: 'Im ersten Dienstjahr beträgt die Kündigungsfrist 1 Monat auf Ende eines Monats.'
            },
            'work_year2_9': {
                name: '2.-9. Dienstjahr',
                article: 'OR Art. 335c',
                months: 2,
                term: 'month_end',
                info: 'Vom 2. bis 9. Dienstjahr beträgt die Kündigungsfrist 2 Monate auf Ende eines Monats.'
            },
            'work_year10': {
                name: 'Ab 10. Dienstjahr',
                article: 'OR Art. 335c',
                months: 3,
                term: 'month_end',
                info: 'Ab dem 10. Dienstjahr beträgt die Kündigungsfrist 3 Monate auf Ende eines Monats.'
            },
            'rent_apartment': {
                name: 'Wohnung',
                article: 'OR Art. 266c',
                months: 3,
                term: 'quarter_end',
                info: 'Wohnungsmiete: 3 Monate Kündigungsfrist auf ortsüblichen Termin (meist Quartalsende).'
            },
            'rent_business': {
                name: 'Geschäftsräume',
                article: 'OR Art. 266d',
                months: 6,
                term: 'quarter_end',
                info: 'Geschäftsmiete: 6 Monate Kündigungsfrist auf ortsüblichen Termin (meist Quartalsende).'
            },
            'rent_room': {
                name: 'Möbliertes Zimmer',
                article: 'OR Art. 266e',
                weeks: 2,
                term: 'month_end',
                info: 'Möblierte Zimmer und Einstellplätze: 2 Wochen Kündigungsfrist auf Monatsende.'
            },
            'rent_parking': {
                name: 'Parkplatz',
                article: 'OR Art. 266e',
                weeks: 2,
                term: 'month_end',
                info: 'Parkplätze und Einstellplätze: 2 Wochen Kündigungsfrist auf Monatsende.'
            },
            'custom': {
                name: 'Individuelle Frist',
                article: 'Vertrag',
                custom: true,
                info: 'Geben Sie die vertraglich vereinbarte Kündigungsfrist ein.'
            },
            // Insurance contracts
            'insurance_health_basic': {
                name: 'Krankenkasse Grundversicherung',
                article: 'KVG Art. 7',
                fixedDate: { month: 10, day: 30 }, // November 30
                term: 'year_end',
                info: 'Grundversicherung: Kündigung muss bis 30. November beim Versicherer eingehen. Wechsel per 1. Januar.'
            },
            'insurance_health_extra': {
                name: 'Krankenkasse Zusatzversicherung',
                article: 'VVG Art. 35',
                months: 3,
                term: 'year_end',
                info: 'Zusatzversicherung: Meist 3 Monate Kündigungsfrist auf Ende Jahr. Prüfen Sie Ihre Police!'
            },
            'insurance_property': {
                name: 'Sach-/Autoversicherung',
                article: 'VVG Art. 35',
                months: 3,
                term: 'policy_year',
                info: 'Sachversicherungen: 3 Monate Kündigungsfrist auf Ende des Versicherungsjahres. Seit VVG 2022 immer kündbar nach 3 Jahren.'
            },
            'insurance_life': {
                name: 'Lebensversicherung',
                article: 'VVG Art. 35',
                months: 3,
                term: 'policy_year',
                info: 'Lebensversicherung: 3 Monate Kündigungsfrist. Achtung: Rückkaufswert kann unter einbezahlten Prämien liegen.'
            },
            // Subscription contracts
            'subscription_fitness': {
                name: 'Fitness-Abo',
                article: 'Vertrag/AGB',
                months: 3,
                term: 'contract_end',
                info: 'Fitness-Abos: Meist 3 Monate vor Ablauf kündbar. Ohne Kündigung automatische Verlängerung. Ausserordentliche Kündigung bei Umzug >30km möglich.'
            },
            'subscription_mobile': {
                name: 'Handy-Abo',
                article: 'Vertrag/AGB',
                days: 60,
                term: 'contract_end',
                info: 'Mobilfunk: Meist 60 Tage Kündigungsfrist. Ohne Kündigung automatische Verlängerung. Prüfen Sie Ihre AGB!'
            },
            'subscription_internet': {
                name: 'Internet/TV-Abo',
                article: 'Vertrag/AGB',
                days: 60,
                term: 'contract_end',
                info: 'Internet/TV: Meist 60 Tage Kündigungsfrist vor Ablauf der Mindestvertragsdauer. Automatische Verlängerung üblich.'
            },
            'subscription_streaming': {
                name: 'Streaming/Zeitschrift',
                article: 'Vertrag/AGB',
                months: 1,
                term: 'month_end',
                info: 'Streaming-Dienste: Meist monatlich kündbar. Zeitschriften: Oft 1 Monat auf Ende einer Aboperiode.'
            }
        };

        function updateContractInfo() {
            const select = document.getElementById('contractType');
            const infoDiv = document.getElementById('contractTypeInfo');
            const customPeriodGroup = document.getElementById('customPeriodGroup');
            const customTermGroup = document.getElementById('customTermGroup');
            const workStartGroup = document.getElementById('workStartGroup');
            const type = contractTypes[select.value];

            if (type) {
                let periodText = '';
                if (type.fixedDate) periodText = 'Feste Frist (30. November)';
                else if (type.days) periodText = `${type.days} Tage`;
                else if (type.weeks) periodText = `${type.weeks} Wochen`;
                else if (type.months) periodText = `${type.months} Monat(e)`;
                else if (type.custom) periodText = 'Individuell';

                let termText = '';
                if (type.term === 'any') termText = 'jederzeit';
                else if (type.term === 'month_end') termText = 'auf Monatsende';
                else if (type.term === 'quarter_end') termText = 'auf Quartalsende';
                else if (type.term === 'year_end') termText = 'auf Ende Jahr';
                else if (type.term === 'policy_year') termText = 'auf Ende Versicherungsjahr';
                else if (type.term === 'contract_end') termText = 'vor Vertragsablauf';

                infoDiv.innerHTML = `
                    <h4>${type.name} – ${type.article}</h4>
                    <p><strong>Kündigungsfrist:</strong> ${periodText} ${termText}</p>
                    <p>${type.info}</p>
                `;
                infoDiv.style.display = 'block';

                // Show/hide custom fields
                customPeriodGroup.style.display = type.custom ? 'block' : 'none';
                customTermGroup.style.display = type.custom ? 'block' : 'none';

                // Show work start date for employment contracts
                const isWorkContract = select.value.startsWith('work_');
                workStartGroup.style.display = isWorkContract ? 'block' : 'none';
            } else {
                infoDiv.style.display = 'none';
                customPeriodGroup.style.display = 'none';
                customTermGroup.style.display = 'none';
                workStartGroup.style.display = 'none';
            }
        }

        function parseDate(dateStr) {
            const parts = dateStr.split('.');
            if (parts.length !== 3) return null;
            return new Date(parts[2], parts[1] - 1, parts[0]);
        }

        function formatDate(date) {
            return date.toLocaleDateString('de-CH', { weekday: 'long', day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        function formatDateShort(date) {
            return date.toLocaleDateString('de-CH', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        function addDays(date, days) {
            const result = new Date(date);
            result.setDate(result.getDate() + days);
            return result;
        }

        function addWeeks(date, weeks) {
            return addDays(date, weeks * 7);
        }

        function addMonths(date, months) {
            const result = new Date(date);
            result.setMonth(result.getMonth() + months);
            return result;
        }

        function getMonthEnd(date) {
            const result = new Date(date.getFullYear(), date.getMonth() + 1, 0);
            return result;
        }

        function getNextQuarterEnd(date) {
            const month = date.getMonth();
            let targetMonth;
            if (month < 2) targetMonth = 2; // March
            else if (month < 5) targetMonth = 5; // June
            else if (month < 8) targetMonth = 8; // September
            else if (month < 11) targetMonth = 11; // December
            else targetMonth = 14; // March next year

            let year = date.getFullYear();
            if (targetMonth > 11) {
                targetMonth -= 12;
                year++;
            }

            return new Date(year, targetMonth + 1, 0); // Last day of target month
        }

        function getYearEnd(date) {
            return new Date(date.getFullYear(), 11, 31); // December 31
        }

        function getNextYearEnd(date) {
            const yearEnd = getYearEnd(date);
            if (date <= yearEnd) return yearEnd;
            return new Date(date.getFullYear() + 1, 11, 31);
        }

        function getTerminationDate(noticeDate, type, customMonths, customTerm) {
            let minEndDate;

            // Special case: fixed deadline (e.g., Krankenkasse Nov 30)
            if (type.fixedDate) {
                const thisYear = new Date(noticeDate.getFullYear(), type.fixedDate.month, type.fixedDate.day);
                const nextYear = new Date(noticeDate.getFullYear() + 1, type.fixedDate.month, type.fixedDate.day);
                // If we're past this year's deadline, return next year's year end
                if (noticeDate > thisYear) {
                    return new Date(noticeDate.getFullYear() + 1, 11, 31); // Next year Dec 31
                }
                return new Date(noticeDate.getFullYear(), 11, 31); // This year Dec 31
            }

            // Calculate minimum end date based on notice period
            if (type.custom) {
                minEndDate = addMonths(noticeDate, parseInt(customMonths) || 1);
            } else if (type.days) {
                minEndDate = addDays(noticeDate, type.days);
            } else if (type.weeks) {
                minEndDate = addWeeks(noticeDate, type.weeks);
            } else if (type.months) {
                minEndDate = addMonths(noticeDate, type.months);
            }

            // Apply term (month end, quarter end, etc.)
            let term = type.custom ? customTerm : type.term;

            if (term === 'month_end') {
                // Find month end that's at or after minEndDate
                let endDate = getMonthEnd(minEndDate);
                if (endDate < minEndDate) {
                    endDate = getMonthEnd(addMonths(minEndDate, 1));
                }
                return endDate;
            } else if (term === 'quarter_end') {
                // Find quarter end that's at or after minEndDate
                let endDate = getNextQuarterEnd(minEndDate);
                while (endDate < minEndDate) {
                    endDate = getNextQuarterEnd(addMonths(endDate, 1));
                }
                return endDate;
            } else if (term === 'year_end') {
                // End of calendar year
                return getNextYearEnd(minEndDate);
            } else if (term === 'policy_year' || term === 'contract_end') {
                // For policy year and contract end, we show based on notice period
                // User should check their contract for exact date
                return minEndDate;
            } else {
                // No specific term - return minEndDate
                return minEndDate;
            }
        }

        document.getElementById('kuendigungForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const contractTypeValue = document.getElementById('contractType').value;
            const noticeDateStr = document.getElementById('noticeDate').value;
            const customMonths = document.getElementById('customMonths').value;
            const customTerm = document.getElementById('customTerm').value;

            if (!contractTypeValue || !noticeDateStr) {
                alert('Bitte füllen Sie alle Pflichtfelder aus.');
                return;
            }

            const type = contractTypes[contractTypeValue];
            const noticeDate = parseDate(noticeDateStr);

            if (!noticeDate) {
                alert('Bitte geben Sie ein gültiges Datum ein.');
                return;
            }

            const terminationDate = getTerminationDate(noticeDate, type, customMonths, customTerm);

            // Calculate notice period description
            let periodDesc = '';
            if (type.fixedDate) {
                periodDesc = 'bis 30. November';
            } else if (type.custom) {
                periodDesc = `${customMonths} Monat(e)`;
            } else if (type.days) {
                periodDesc = `${type.days} Tage`;
            } else if (type.weeks) {
                periodDesc = `${type.weeks} Wochen`;
            } else if (type.months) {
                periodDesc = `${type.months} Monat(e)`;
            }

            let termDesc = '';
            let term = type.custom ? customTerm : type.term;
            if (term === 'month_end') termDesc = 'auf Monatsende';
            else if (term === 'quarter_end') termDesc = 'auf Quartalsende (ortsüblich)';
            else if (term === 'year_end') termDesc = 'auf Ende Jahr';
            else if (term === 'policy_year') termDesc = 'auf Ende Versicherungsjahr';
            else if (term === 'contract_end') termDesc = 'vor Vertragsablauf';
            else termDesc = 'jederzeit';

            // Build result
            let resultHTML = `
                <h3>Ergebnis</h3>
                <table class="result-table">
                    <tr>
                        <td>Vertragsart:</td>
                        <td><strong>${type.name}</strong></td>
                    </tr>
                    <tr>
                        <td>Rechtsgrundlage:</td>
                        <td>${type.article}</td>
                    </tr>
                    <tr>
                        <td>Kündigungsfrist:</td>
                        <td>${periodDesc} ${termDesc}</td>
                    </tr>
                    <tr>
                        <td>Kündigung zugestellt am:</td>
                        <td>${formatDateShort(noticeDate)}</td>
                    </tr>
                    <tr class="result-total">
                        <td><strong>Frühester Beendigungstermin:</strong></td>
                        <td><strong>${formatDate(terminationDate)}</strong></td>
                    </tr>
                </table>

                <div class="timeline-visual">
                    <h4 style="margin: 0 0 10px 0; color: #3f606f;">Zeitlicher Ablauf</h4>
                    <div class="timeline-bar">
                        <div class="timeline-point">
                            <div class="dot"></div>
                            <small>Kündigung<br>${formatDateShort(noticeDate)}</small>
                        </div>
                        <div class="timeline-line"></div>
                        <div class="timeline-point">
                            <div class="dot end"></div>
                            <small>Ende<br>${formatDateShort(terminationDate)}</small>
                        </div>
                    </div>
                </div>
            `;

            // Add warnings for specific cases
            if (contractTypeValue.startsWith('rent_')) {
                resultHTML += `
                    <div class="warning" style="margin-top: 20px;">
                        <i class="fas fa-info-circle"></i>
                        <strong>Hinweis:</strong> Bei Wohnungsmiete muss die Kündigung auf dem amtlichen Formular erfolgen. Die Kündigung muss spätestens am letzten Tag vor Beginn der Kündigungsfrist beim Empfänger eingehen.
                    </div>
                `;
            }

            if (contractTypeValue.startsWith('insurance_')) {
                resultHTML += `
                    <div class="warning" style="margin-top: 20px;">
                        <i class="fas fa-info-circle"></i>
                        <strong>Hinweis:</strong> Die Kündigung muss beim Versicherer eingehen (nicht Poststempel). Prüfen Sie Ihre Police für das genaue Versicherungsjahr. Nach Schadenfall: Sonderkündigungsrecht innert 14 Tagen.
                    </div>
                `;
            }

            if (contractTypeValue.startsWith('subscription_')) {
                resultHTML += `
                    <div class="warning" style="margin-top: 20px;">
                        <i class="fas fa-info-circle"></i>
                        <strong>Hinweis:</strong> Die angegebenen Fristen sind branchenüblich. Prüfen Sie Ihre AGB für die genaue Frist! Ohne rechtzeitige Kündigung erfolgt meist automatische Verlängerung.
                    </div>
                `;
            }

            document.querySelector('.result-summary').innerHTML = resultHTML;
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });

            // Daten für PDF-Export speichern
            saveKuendigungData(
                type.name,
                `${periodDesc} ${termDesc}`,
                noticeDate,
                noticeDate, // latestNoticeDate = Zustelldatum
                terminationDate
            );
        });

        // Initialize date pickers
        document.addEventListener('DOMContentLoaded', function() {
            flatpickr("#noticeDate", { dateFormat: "d.m.Y", allowInput: true, defaultDate: "today" });
            flatpickr("#workStartDate", { dateFormat: "d.m.Y", allowInput: true });
        });

        function printResult() {
            document.getElementById('printDate').textContent = 'Erstellt am: ' + new Date().toLocaleDateString('de-CH');
            window.print();
        }

        // PDF Export
        let lastKuendigungData = null;

        function saveKuendigungData(contractType, noticePeriod, plannedDate, latestNoticeDate, terminationDate) {
            lastKuendigungData = {
                contractType: contractType,
                noticePeriod: noticePeriod,
                plannedDate: plannedDate,
                latestNoticeDate: latestNoticeDate,
                terminationDate: terminationDate
            };
        }

        function exportPDF() {
            if (!lastKuendigungData) {
                alert('Bitte berechnen Sie zuerst den Kündigungstermin.');
                return;
            }
            if (typeof KuendigungPdfExport !== 'undefined') {
                KuendigungPdfExport.generatePDF(lastKuendigungData, 'de');
            } else {
                printResult();
            }
        }

        function acceptDisclaimer() {
            document.getElementById('disclaimerModal').style.display = 'none';
            localStorage.setItem('kuendigung_disclaimer_accepted', 'true');
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (!localStorage.getItem('kuendigung_disclaimer_accepted')) {
                document.getElementById('disclaimerModal').style.display = 'flex';
            }
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.3/jspdf.umd.min.js"></script>
    <script src="../scripts/pdf-export.js"></script>
</body>
</html>
