<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schweizer Verjährungsrechner - Verjährungsfristen berechnen</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <meta name="description" content="Berechnen Sie Verjährungsfristen nach Schweizer Obligationenrecht. Für Forderungen, Schadenersatz, Kaufverträge und mehr.">
    <meta name="keywords" content="Verjährungsrechner, Verjährungsfrist, OR Art. 127, OR Art. 128, Schweiz, Verjährung, Forderung, Schadenersatz">
    <meta name="author" content="Durchblick Consultancy BV">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://frist.ch/de/verjaehrung.html">
    <meta property="og:title" content="Schweizer Verjährungsrechner - Verjährungsfristen berechnen">
    <meta property="og:description" content="Berechnen Sie Verjährungsfristen nach Schweizer Obligationenrecht. Für Forderungen, Schadenersatz und mehr.">
    <meta property="og:image" content="https://frist.ch/images/og-frist-de.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="de_CH">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Schweizer Verjährungsrechner - Verjährungsfristen berechnen">
    <meta name="twitter:description" content="Berechnen Sie Verjährungsfristen nach Schweizer Obligationenrecht. Für Forderungen, Schadenersatz und mehr.">
    <meta name="twitter:image" content="https://frist.ch/images/og-frist-de.png">

    <!-- Canonical & Language -->
    <link rel="canonical" href="https://frist.ch/de/verjaehrung.html">
    <link rel="alternate" hreflang="de" href="https://frist.ch/de/verjaehrung.html">
    <link rel="alternate" hreflang="fr" href="https://frist.ch/fr/verjaehrung.html">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Schweizer Verjährungsrechner",
        "description": "Berechnen Sie Verjährungsfristen nach Schweizer Obligationenrecht",
        "url": "https://frist.ch/de/verjaehrung.html",
        "applicationCategory": "LegalService",
        "operatingSystem": "Web",
        "inLanguage": "de-CH",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CHF"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Durchblick Consultancy BV",
            "url": "https://durchblick.nl"
        }
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Economica:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .tool-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tool-nav a {
            padding: 8px 16px;
            background: #f5f5f5;
            border-radius: 4px;
            text-decoration: none;
            color: #3f606f;
            font-family: 'Economica', sans-serif;
            font-weight: 600;
            transition: all 0.2s;
        }
        .tool-nav a:hover {
            background: #e0e0e0;
        }
        .tool-nav a.active {
            background: #3f606f;
            color: white;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            margin-left: 10px;
        }
        .status-ok {
            background: #d4edda;
            color: #155724;
        }
        .status-warning {
            background: #fff3cd;
            color: #856404;
        }
        .status-danger {
            background: #f8d7da;
            color: #721c24;
        }
        .status-expired {
            background: #e2e3e5;
            color: #383d41;
        }
        .countdown {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3f606f;
            margin: 15px 0;
        }
        .claim-type-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #3f606f;
        }
        .claim-type-info h4 {
            margin: 0 0 8px 0;
            color: #3f606f;
        }
        .claim-type-info p {
            margin: 0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-row">
            <div class="language-switcher">
                <a href="../de/verjaehrung.html" class="lang-btn active">DE</a>
                <a href="../fr/verjaehrung.html" class="lang-btn">FR</a>
            </div>
        </div>

        <h1><img src="../favicon.svg" alt="" class="title-icon">Schweizer Verjährungsrechner</h1>

        <nav class="tool-nav">
            <a href="../de/">Fristenrechner</a>
            <a href="../de/verjaehrung.html" class="active">Verjährungsrechner</a>
            <a href="../de/kuendigung.html">Kündigungsfristen</a>
        </nav>

        <div class="steps-container">
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-file-contract"></i>
                    <div class="step-number">1</div>
                </div>
                <div class="step-content">
                    <h3>Anspruchsart wählen</h3>
                    <p>Wählen Sie die Art des Anspruchs. Je nach Anspruchsart gelten unterschiedliche Verjährungsfristen.</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-calendar-day"></i>
                    <div class="step-number">2</div>
                </div>
                <div class="step-content">
                    <h3>Fristbeginn eingeben</h3>
                    <p>Geben Sie das Datum ein, an dem die Verjährung zu laufen begann (z.B. Fälligkeit, Kenntnis des Schadens).</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-hourglass-half"></i>
                    <div class="step-number">3</div>
                </div>
                <div class="step-content">
                    <h3>Verjährung prüfen</h3>
                    <p>Erfahren Sie, bis wann der Anspruch geltend gemacht werden muss und wie die Verjährung unterbrochen werden kann.</p>
                </div>
            </div>
        </div>

        <div class="calculator-card">
            <form id="verjaehrungForm">
                <div class="form-group">
                    <label for="claimType" class="required">Art des Anspruchs
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Je nach Anspruchsart gelten unterschiedliche Verjährungsfristen nach Schweizer Obligationenrecht.</span>
                        </span>
                    </label>
                    <select id="claimType" name="claimType" required onchange="updateClaimInfo()">
                        <option value="">Bitte wählen...</option>
                        <optgroup label="10 Jahre (OR Art. 127)">
                            <option value="general_10">Allgemeine Forderungen (z.B. Darlehen, Kaufpreis)</option>
                            <option value="contract_10">Vertragliche Ansprüche (allgemein)</option>
                            <option value="judgment_10">Gerichtsurteile und Vergleiche</option>
                        </optgroup>
                        <optgroup label="5 Jahre (OR Art. 128)">
                            <option value="rent_5">Miet- und Pachtzinsen</option>
                            <option value="salary_5">Lohn und Gehalt</option>
                            <option value="interest_5">Zinsen und Renten</option>
                            <option value="alimony_5">Unterhaltsbeiträge</option>
                            <option value="board_5">Verpflegung, Pensionskosten</option>
                            <option value="craft_5">Handwerkerarbeiten</option>
                            <option value="retail_5">Detailhandel (Warenlieferungen)</option>
                            <option value="medical_5">Arzt- und Anwaltsrechnungen</option>
                            <option value="building_5">Werkmängel an Bauwerken (OR Art. 371)</option>
                        </optgroup>
                        <optgroup label="3 Jahre (OR Art. 60/67)">
                            <option value="tort_3">Schadenersatz aus unerlaubter Handlung</option>
                            <option value="enrichment_3">Ungerechtfertigte Bereicherung</option>
                            <option value="injury_3">Personenschäden (seit 1.1.2020)</option>
                        </optgroup>
                        <optgroup label="2 Jahre (OR Art. 210/371)">
                            <option value="sale_2">Kaufvertrag: Mängelrüge bewegliche Sachen</option>
                            <option value="work_defect_2">Werkvertrag: Mängel an beweglichen Werken</option>
                        </optgroup>
                        <optgroup label="1 Jahr">
                            <option value="transport_1">Transportschäden (OR Art. 454)</option>
                        </optgroup>
                        <optgroup label="Spezialfälle">
                            <option value="loss_certificate_20">Verlustscheine (20 Jahre)</option>
                            <option value="culture_30">Kulturgüter (1 + 30 Jahre)</option>
                            <option value="regress_3">Regress bei Solidarhaftung (3 Jahre)</option>
                            <option value="insurance_5">Versicherungsansprüche (5 Jahre, seit 2022)</option>
                        </optgroup>
                    </select>
                    <div id="claimTypeInfo" class="claim-type-info" style="display: none;"></div>
                </div>

                <div class="form-group">
                    <label for="startDate" class="required">Beginn der Verjährung
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Das Datum, an dem die Verjährungsfrist zu laufen begann. Bei Forderungen: Fälligkeit. Bei Schadenersatz: Kenntnis des Schadens und des Ersatzpflichtigen.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="startDate"
                           name="startDate"
                           required
                           title="Beginn der Verjährung"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: TT.MM.JJJJ</small>
                </div>

                <div class="form-group" id="absoluteDateGroup" style="display: none;">
                    <label for="absoluteDate">Datum des schädigenden Ereignisses (absolute Frist)
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Neben der relativen Frist (ab Kenntnis) gilt eine absolute Frist ab dem schädigenden Ereignis.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="absoluteDate"
                           name="absoluteDate"
                           title="Datum des Ereignisses"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: TT.MM.JJJJ (optional, für absolute Verjährung)</small>
                </div>

                <div class="form-group">
                    <label>Verjährungsunterbrechung (OR Art. 135)
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Wurde die Verjährung unterbrochen? Nach einer Unterbrechung beginnt eine neue Verjährungsfrist zu laufen.</span>
                        </span>
                    </label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="interrupted" onchange="toggleInterruptionDate()">
                            Verjährung wurde unterbrochen
                        </label>
                    </div>
                </div>

                <div class="form-group" id="interruptionDateGroup" style="display: none;">
                    <label for="interruptionDate" class="required">Datum der Unterbrechung
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Unterbrechungsgründe: Schuldanerkennung, Betreibung, Klage, Schlichtungsgesuch. Ab diesem Datum beginnt eine neue Frist.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="interruptionDate"
                           name="interruptionDate"
                           title="Datum der Unterbrechung"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: TT.MM.JJJJ</small>
                </div>

                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    Achtung: Dieser Rechner dient nur zur Orientierung. Die Verjährungsberechnung kann komplex sein. Im Zweifelsfall konsultieren Sie einen Rechtsanwalt.
                </div>

                <button type="submit">Verjährung berechnen</button>
            </form>

            <div id="result" class="result" style="display: none;">
                <div class="result-actions">
                    <button type="button" onclick="printResult()" class="print-button">
                        <i class="fas fa-print"></i> Ergebnis drucken
                    </button>
                </div>
                <div class="result-summary"></div>
            </div>
        </div>

        <div class="info-cards-container">
            <div class="info-step-card highlight">
                <div class="step-icon">
                    <i class="fas fa-hourglass-end"></i>
                </div>
                <div class="step-content">
                    <h3>Verjährungsfristen im Überblick</h3>
                    <ul>
                        <li><strong>10 Jahre:</strong> Allgemeine Forderungen (OR Art. 127)</li>
                        <li><strong>5 Jahre:</strong> Periodische Leistungen wie Miete, Lohn (OR Art. 128)</li>
                        <li><strong>3 Jahre:</strong> Schadenersatz, ungerechtfertigte Bereicherung (OR Art. 60/67)</li>
                        <li><strong>2 Jahre:</strong> Mängelrüge beim Kauf (OR Art. 210)</li>
                        <li><strong>1 Jahr:</strong> Transportschäden, Versicherungsansprüche</li>
                    </ul>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-redo"></i>
                </div>
                <div class="step-content">
                    <h3>Unterbrechung der Verjährung</h3>
                    <p>Die Verjährung wird unterbrochen durch (OR Art. 135):</p>
                    <ul>
                        <li>Schuldanerkennung (inkl. Zins- oder Abschlagszahlung)</li>
                        <li>Betreibung oder Konkursbegehren</li>
                        <li>Klage oder Schlichtungsgesuch</li>
                        <li>Einrede im Prozess</li>
                    </ul>
                    <p style="margin-top: 0.5rem;">Nach Unterbrechung beginnt eine <strong>neue Frist</strong> zu laufen.</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-pause-circle"></i>
                </div>
                <div class="step-content">
                    <h3>Stillstand der Verjährung</h3>
                    <p>Die Verjährung steht still (OR Art. 134):</p>
                    <ul>
                        <li>Während Stundung</li>
                        <li>Bei Unmöglichkeit der Rechtsverfolgung</li>
                        <li>Zwischen Ehegatten während der Ehe</li>
                        <li>Gegenüber Minderjährigen (solange keine Vertretung)</li>
                    </ul>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-exclamation-circle"></i>
                </div>
                <div class="step-content">
                    <h3>Wichtige Hinweise</h3>
                    <p><strong>Relative vs. absolute Frist:</strong> Bei Schadenersatz gilt neben der relativen Frist (ab Kenntnis) eine absolute Frist ab dem schädigenden Ereignis.</p>
                    <p style="margin-top: 0.5rem;"><strong>Seit 1.1.2020:</strong> Personenschäden verjähren nach 3 Jahren (relativ) / 20 Jahren (absolut).</p>
                </div>
            </div>
        </div>

        <div class="law-section">
            <h2>Gesetzliche Grundlagen</h2>
            <p class="law-subtitle">Schweizerisches Obligationenrecht (OR)</p>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_127" target="_blank" rel="noopener">Art. 127 OR – Zehnjährige Frist <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <p>Mit Ablauf von zehn Jahren verjähren alle Forderungen, für die das Bundeszivilrecht nicht etwas anderes bestimmt.</p>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_128" target="_blank" rel="noopener">Art. 128 OR – Fünfjährige Frist <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <p>Mit Ablauf von fünf Jahren verjähren die Forderungen:</p>
                    <ol>
                        <li>für Miet-, Pacht- und Kapitalzinse sowie für andere periodische Leistungen;</li>
                        <li>aus Lieferung von Lebensmitteln, für Beköstigung und für Wirtsschulden;</li>
                        <li>aus Handwerksarbeit, Kleinverkauf von Waren, ärztlicher Besorgung, Berufsarbeiten von Anwälten, Rechtsagenten, Prokuratoren und Notaren sowie aus dem Arbeitsverhältnis von Arbeitnehmern.</li>
                    </ol>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_60" target="_blank" rel="noopener">Art. 60 OR – Schadenersatz <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <ol>
                        <li>Der Anspruch auf Schadenersatz oder Genugtuung verjährt mit Ablauf von drei Jahren von dem Tage an gerechnet, an welchem der Geschädigte Kenntnis vom Schaden und von der Person des Ersatzpflichtigen erlangt hat, jedenfalls aber mit Ablauf von zehn Jahren, vom Tage an gerechnet, an welchem das schädigende Verhalten erfolgte oder aufhörte.</li>
                        <li>Hat die ersatzpflichtige Person durch ihr schädigendes Verhalten eine strafbare Handlung begangen, so verjährt der Anspruch auf Schadenersatz oder Genugtuung frühestens mit Eintritt der strafrechtlichen Verfolgungsverjährung.</li>
                    </ol>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3><a href="https://www.fedlex.admin.ch/eli/cc/27/317_321_377/de#art_135" target="_blank" rel="noopener">Art. 135 OR – Unterbrechung <i class="fas fa-external-link-alt"></i></a></h3>
                </div>
                <div class="law-content">
                    <p>Die Verjährung wird unterbrochen:</p>
                    <ol>
                        <li>durch Anerkennung der Forderung von seiten des Schuldners, namentlich auch durch Zins- und Abschlagszahlungen, Pfand- und Bürgschaftsbestellung;</li>
                        <li>durch Schuldbetreibung, durch Schlichtungsgesuch, durch Klage oder Einrede vor einem staatlichen Gericht oder einem Schiedsgericht sowie durch Eingabe im Konkurs.</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p>
                <a href="https://durchblick.nl/tools_de.html" target="_blank" rel="noopener">Durchblick Consultancy BV</a>
                &nbsp;•&nbsp;
                <a href="https://github.com/durchblick-nl/frist" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i> Source Code auf GitHub
                </a>
            </p>
            <p class="footer-disclaimer">Dieser Rechner dient nur zur Orientierung. Keine Rechtsberatung.</p>
        </div>
    </footer>

    <div class="print-header" style="display: none;">
        <img src="https://www.durchblick.nl/images/durchblick_logo.svg"
             alt="Durchblick Consultancy Logo">
        <div>
            <h2>Verjährungsberechnung</h2>
            <p id="printDate" style="font-size: 0.9rem; color: #666; margin-top: 0.25rem;"></p>
        </div>
    </div>

    <div class="print-footer" style="display: none;">
        <p><strong>frist.ch</strong> – Verjährungsrechner nach Schweizerischem Obligationenrecht</p>
        <p>Dieser Ausdruck dient nur zur Orientierung. Keine Rechtsberatung.</p>
    </div>

    <div id="disclaimerModal" class="modal">
        <div class="modal-content">
            <h2>Rechtlicher Hinweis</h2>
            <div class="disclaimer-text">
                <p><strong>Haftungsausschluss und Nutzungsbedingungen</strong></p>
                <p>Durchblick Consultancy BV stellt diesen Verjährungsrechner als unverbindliches Hilfsmittel zur Verfügung. Trotz sorgfältiger Entwicklung kann keine Gewähr für die Richtigkeit der Berechnungen übernommen werden.</p>

                <p>Insbesondere wird darauf hingewiesen:</p>
                <ul>
                    <li>Der Rechner dient nur zur Orientierung und ersetzt keine Rechtsberatung.</li>
                    <li>Verjährungsfristen können je nach Einzelfall variieren.</li>
                    <li>Durchblick Consultancy BV übernimmt keine Haftung für Schäden aus der Nutzung.</li>
                </ul>

                <p>Mit der Nutzung akzeptieren Sie diese Bedingungen.</p>
            </div>
            <button onclick="acceptDisclaimer()" class="accept-button">
                Ich habe den Hinweis gelesen und akzeptiere die Bedingungen
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        // Claim type configurations
        const claimTypes = {
            // 10 years
            'general_10': { years: 10, name: 'Allgemeine Forderungen', article: 'OR Art. 127', info: 'Gilt für alle Forderungen, die nicht unter eine spezielle Verjährungsfrist fallen.' },
            'contract_10': { years: 10, name: 'Vertragliche Ansprüche', article: 'OR Art. 127', info: 'Allgemeine vertragliche Ansprüche wie Kaufpreis, Darlehen, Werklohn.' },
            'judgment_10': { years: 10, name: 'Gerichtsurteile', article: 'OR Art. 137', info: 'Rechtskräftige Urteile und gerichtliche Vergleiche verjähren nach 10 Jahren.' },
            // 5 years
            'rent_5': { years: 5, name: 'Miet- und Pachtzinsen', article: 'OR Art. 128 Ziff. 1', info: 'Gilt für Mietzinsforderungen, nicht für Nebenkosten-Nachzahlungen.' },
            'salary_5': { years: 5, name: 'Lohn und Gehalt', article: 'OR Art. 128 Ziff. 3', info: 'Lohnforderungen aus Arbeitsvertrag. Bonusansprüche können unter Umständen anders verjähren.' },
            'interest_5': { years: 5, name: 'Zinsen und Renten', article: 'OR Art. 128 Ziff. 1', info: 'Periodisch geschuldete Zinsen und Renten.' },
            'alimony_5': { years: 5, name: 'Unterhaltsbeiträge', article: 'OR Art. 128 Ziff. 1', info: 'Periodische Unterhaltsforderungen aus Familienrecht.' },
            'board_5': { years: 5, name: 'Verpflegung, Pension', article: 'OR Art. 128 Ziff. 2', info: 'Forderungen aus Beköstigung, Verpflegung und Wirtsschulden.' },
            'craft_5': { years: 5, name: 'Handwerkerarbeiten', article: 'OR Art. 128 Ziff. 3', info: 'Handwerkerforderungen, Reparaturen, kleinere Aufträge.' },
            'retail_5': { years: 5, name: 'Detailhandel', article: 'OR Art. 128 Ziff. 3', info: 'Kleinverkauf von Waren an Endverbraucher.' },
            'medical_5': { years: 5, name: 'Arzt- und Anwaltsrechnungen', article: 'OR Art. 128 Ziff. 3', info: 'Honorarforderungen von Ärzten, Anwälten, Notaren.' },
            'building_5': { years: 5, name: 'Werkmängel an Bauwerken', article: 'OR Art. 371', info: 'Mängelansprüche bei unbeweglichen Bauwerken. Bei beweglichen Werken: 2 Jahre.' },
            // 3 years
            'tort_3': { years: 3, absoluteYears: 10, name: 'Schadenersatz (Delikt)', article: 'OR Art. 60', info: '3 Jahre ab Kenntnis von Schaden und Schädiger, max. 10 Jahre ab schädigendem Ereignis.', hasAbsolute: true },
            'enrichment_3': { years: 3, absoluteYears: 10, name: 'Ungerechtfertigte Bereicherung', article: 'OR Art. 67', info: '3 Jahre ab Kenntnis des Anspruchs, max. 10 Jahre ab Entstehung.', hasAbsolute: true },
            'injury_3': { years: 3, absoluteYears: 20, name: 'Personenschäden', article: 'OR Art. 60 (seit 2020)', info: '3 Jahre ab Kenntnis, max. 20 Jahre ab schädigendem Ereignis. Gilt seit 1.1.2020.', hasAbsolute: true },
            // 2 years
            'sale_2': { years: 2, name: 'Kaufvertrag Mängel', article: 'OR Art. 210', info: 'Mängelansprüche bei Kaufverträgen über bewegliche Sachen. Frist beginnt mit Ablieferung.' },
            'work_defect_2': { years: 2, name: 'Werkvertrag Mängel (beweglich)', article: 'OR Art. 371', info: 'Mängelansprüche bei beweglichen Werken. Bei unbeweglichen Werken: 5 Jahre.' },
            // 1 year
            'transport_1': { years: 1, name: 'Transportschäden', article: 'OR Art. 454', info: 'Ansprüche aus Frachtvertrag.' },
            // Special cases
            'loss_certificate_20': { years: 20, name: 'Verlustscheine', article: 'OR Art. 149a', info: 'Forderungen aus Verlustscheinen verjähren 20 Jahre nach Ausstellung.' },
            'culture_30': { years: 1, absoluteYears: 30, name: 'Kulturgüter', article: 'OR Art. 210 Abs. 3', info: '1 Jahr ab Kenntnis, max. 30 Jahre ab Erwerb. Für rechtswidrig entzogene Kulturgüter.', hasAbsolute: true },
            'regress_3': { years: 3, name: 'Regress Solidarhaftung', article: 'OR Art. 139', info: 'Regressansprüche unter Solidarschuldnern verjähren 3 Jahre ab Zahlung.' },
            'insurance_5': { years: 5, name: 'Versicherungsansprüche', article: 'VVG Art. 46 (seit 2022)', info: 'Seit 2022 verjähren Versicherungsansprüche nach 5 Jahren (zuvor 2 Jahre).' }
        };

        function updateClaimInfo() {
            const select = document.getElementById('claimType');
            const infoDiv = document.getElementById('claimTypeInfo');
            const absoluteGroup = document.getElementById('absoluteDateGroup');
            const type = claimTypes[select.value];

            if (type) {
                infoDiv.innerHTML = `
                    <h4>${type.name} – ${type.article}</h4>
                    <p><strong>Verjährungsfrist:</strong> ${type.years} Jahre${type.absoluteYears ? ` (relativ) / ${type.absoluteYears} Jahre (absolut)` : ''}</p>
                    <p>${type.info}</p>
                `;
                infoDiv.style.display = 'block';

                // Show absolute date field for claims with dual limitation
                if (type.hasAbsolute) {
                    absoluteGroup.style.display = 'block';
                } else {
                    absoluteGroup.style.display = 'none';
                }
            } else {
                infoDiv.style.display = 'none';
                absoluteGroup.style.display = 'none';
            }
        }

        function toggleInterruptionDate() {
            const checkbox = document.getElementById('interrupted');
            const group = document.getElementById('interruptionDateGroup');
            group.style.display = checkbox.checked ? 'block' : 'none';
        }

        function parseDate(dateStr) {
            const parts = dateStr.split('.');
            if (parts.length !== 3) return null;
            return new Date(parts[2], parts[1] - 1, parts[0]);
        }

        function formatDate(date) {
            return date.toLocaleDateString('de-CH', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        function addYears(date, years) {
            const result = new Date(date);
            result.setFullYear(result.getFullYear() + years);
            return result;
        }

        function daysBetween(date1, date2) {
            const diffTime = date2 - date1;
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        document.getElementById('verjaehrungForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const claimTypeValue = document.getElementById('claimType').value;
            const startDateStr = document.getElementById('startDate').value;
            const absoluteDateStr = document.getElementById('absoluteDate').value;
            const interrupted = document.getElementById('interrupted').checked;
            const interruptionDateStr = document.getElementById('interruptionDate').value;

            if (!claimTypeValue || !startDateStr) {
                alert('Bitte füllen Sie alle Pflichtfelder aus.');
                return;
            }

            const type = claimTypes[claimTypeValue];
            let startDate = parseDate(startDateStr);

            if (!startDate) {
                alert('Bitte geben Sie ein gültiges Datum ein.');
                return;
            }

            // If interrupted, use interruption date as new start
            if (interrupted && interruptionDateStr) {
                const interruptionDate = parseDate(interruptionDateStr);
                if (interruptionDate) {
                    startDate = interruptionDate;
                }
            }

            // Calculate expiration date
            const expirationDate = addYears(startDate, type.years);

            // Calculate absolute expiration if applicable
            let absoluteExpiration = null;
            if (type.hasAbsolute && absoluteDateStr) {
                const absoluteDate = parseDate(absoluteDateStr);
                if (absoluteDate) {
                    absoluteExpiration = addYears(absoluteDate, type.absoluteYears);
                }
            }

            // Determine which date is earlier (relevant expiration)
            let relevantExpiration = expirationDate;
            let isAbsoluteRelevant = false;
            if (absoluteExpiration && absoluteExpiration < expirationDate) {
                relevantExpiration = absoluteExpiration;
                isAbsoluteRelevant = true;
            }

            // Calculate days remaining
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const daysRemaining = daysBetween(today, relevantExpiration);

            // Determine status
            let status, statusClass, statusText;
            if (daysRemaining < 0) {
                status = 'expired';
                statusClass = 'status-expired';
                statusText = 'Verjährt';
            } else if (daysRemaining <= 30) {
                status = 'danger';
                statusClass = 'status-danger';
                statusText = 'Kritisch';
            } else if (daysRemaining <= 180) {
                status = 'warning';
                statusClass = 'status-warning';
                statusText = 'Achtung';
            } else {
                status = 'ok';
                statusClass = 'status-ok';
                statusText = 'Aktiv';
            }

            // Build result HTML
            let resultHTML = `
                <h3>Ergebnis <span class="status-badge ${statusClass}">${statusText}</span></h3>
                <table class="result-table">
                    <tr>
                        <td>Anspruchsart:</td>
                        <td><strong>${type.name}</strong></td>
                    </tr>
                    <tr>
                        <td>Rechtsgrundlage:</td>
                        <td>${type.article}</td>
                    </tr>
                    <tr>
                        <td>Verjährungsfrist:</td>
                        <td>${type.years} Jahre${type.absoluteYears ? ` (relativ) / ${type.absoluteYears} Jahre (absolut)` : ''}</td>
                    </tr>
                    ${interrupted ? `
                    <tr>
                        <td>Unterbrochen am:</td>
                        <td>${interruptionDateStr}</td>
                    </tr>
                    ` : ''}
                    <tr>
                        <td>Fristbeginn:</td>
                        <td>${formatDate(startDate)}</td>
                    </tr>
            `;

            if (type.hasAbsolute && absoluteExpiration) {
                resultHTML += `
                    <tr>
                        <td>Relative Verjährung:</td>
                        <td>${formatDate(expirationDate)}</td>
                    </tr>
                    <tr>
                        <td>Absolute Verjährung:</td>
                        <td>${formatDate(absoluteExpiration)}</td>
                    </tr>
                `;
            }

            resultHTML += `
                    <tr class="result-total">
                        <td><strong>Verjährung am:</strong></td>
                        <td><strong>${formatDate(relevantExpiration)}</strong>${isAbsoluteRelevant ? ' (absolute Frist)' : ''}</td>
                    </tr>
                </table>
            `;

            if (daysRemaining >= 0) {
                resultHTML += `<div class="countdown">Verbleibend: ${daysRemaining} Tage</div>`;
            } else {
                resultHTML += `<div class="countdown" style="color: #721c24;">Verjährt seit ${Math.abs(daysRemaining)} Tagen</div>`;
            }

            // Add recommendations
            if (status === 'danger' || status === 'warning') {
                resultHTML += `
                    <div class="warning" style="margin-top: 20px;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Empfehlung:</strong> Die Verjährung läuft bald ab. Erwägen Sie eine Unterbrechung durch:
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Betreibung einleiten</li>
                            <li>Schlichtungsgesuch einreichen</li>
                            <li>Schuldanerkennung erwirken</li>
                        </ul>
                    </div>
                `;
            }

            document.querySelector('.result-summary').innerHTML = resultHTML;
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        });

        // Initialize date pickers
        document.addEventListener('DOMContentLoaded', function() {
            flatpickr("#startDate", { dateFormat: "d.m.Y", allowInput: true });
            flatpickr("#absoluteDate", { dateFormat: "d.m.Y", allowInput: true });
            flatpickr("#interruptionDate", { dateFormat: "d.m.Y", allowInput: true });
        });

        function printResult() {
            document.getElementById('printDate').textContent = 'Erstellt am: ' + new Date().toLocaleDateString('de-CH');
            window.print();
        }

        // Disclaimer modal
        function acceptDisclaimer() {
            document.getElementById('disclaimerModal').style.display = 'none';
            localStorage.setItem('verjaehrung_disclaimer_accepted', 'true');
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (!localStorage.getItem('verjaehrung_disclaimer_accepted')) {
                document.getElementById('disclaimerModal').style.display = 'flex';
            }
        });
    </script>
</body>
</html>
